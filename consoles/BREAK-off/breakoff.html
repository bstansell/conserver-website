<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Console Server BREAK-off Testing</title>


  <meta name="GENERATOR" content="Nvu 1.0">

  <meta name="KEYWORD" content="Cisco, Xylogics, Annex, MicroAnnex,
Micro-Annex, Xyplex, Conserver, CS-500, cs-516, MaxServer, Cyclades,
Lightwave 3200, Zonker, conserver, NM-32A, Livingston, DLM-200,
portmaster, serial BREAK, IOLAN, computone, RAS2000, DLM-250
Benedict Computing, console server, Datatran, DECServer, N6UOW,
Digi, CM, Perle, Lantronix, Raritan, moxa, CN2510, OpenGear,
CM4116, CS9000, C2600, C2800, C3600, C3800, HWIC-8A, HWIC-16A">

<BODY TEXT="#336600" BGCOLOR="#FFFFFF">

</head>
<body>
<p><center><table border=0 width="98%">
   <tr>
      <td width="40%">
         <P><center><a href="http://www.conserver.com"><img
         src="../conserver-sm.jpg" alt="Conserver.com logo" width=147
         height=47 border=0 align=middle></A></center>
      </td><td width="20%">
      <center><a href="http://www.conserver.com/consoles/"><img
         src="../home-marble.gif" alt="link to the Consoles home page" width=47
         height=50 border=0 align=middle></A></center>
      </td><td width="40%">
         <p><center>Brought to you by;<br>

         <a href="http://www.conserver.com/">www.conserver.com</a></center>
      </td>
   </tr>
</table></center>


<h2 align="center">Console Server BREAK-Off</h2>

<h4 align="center">http://www.conserver.com/console/BREAK-off/breakoff.html<br>

version 1.3 (updated:May 06, 2009, 10:17 pm
)</h4>

<h4 align="center">Questions about testing? email <b>break-off</b>
at<!-- SPAM harvester killer --> <b>conserver.com</b></h4>

<p>
<table style="width: 100%;" border="0">

  <tbody>

    <tr>

      <td>
      <p>This document is the original page from when we planned
to begin testing, and was updated as testing progressed. Other pages
detail our <a href="breakinfo.html">testing
results</a> (which servers passed our tests, and which didn't),
our <a href="breaktest.html">test methodologies</a>,
and <a href="breakacks.html">credits and acknowledgments</a>.</p>

      <p>Are you curious <a href="../about.html">why
I do this</a>? The information from testing has benefited my
employers
and their customers, but I post the information freely to the web, in
the
hopes that it will help others as well. Remote Serial Console Access
still seems to be
one of the best kept secrets of Sysadmin and Netadmin...I'm out to
change that. I don't charge for testing products, and the vendors who
participate get some feedback on their product, user interface,
packaging, documentation, sometimes their support services, and other
aspects of the customer experience. In return, I get more experience
with the newer products, and other folks get the benefit of comparing
my results without needing to perform the testing themselves. It's a
win-win-win situation.&nbsp;</p>

      <table style="text-align: left; width: 100%;" border="1" cellpadding="5" cellspacing="2">

        <tbody>

          <tr>

            <td style="vertical-align: top;">
            <p><b>Equipment desired for the testing</b></p>

            <ul>

              <li>A digital oscilloscope, capable of
printing/exporting
waveforms? </li>

            </ul>

            <p>I did get a terrific serial line protocol analyzer
from <a href="http://www.protocolanalyser.com/">Benedict
Communication</a>, their model <b>DLM-200</b>. (The
DLM-200 page is no longer there, but you can see the bigger brother,
the <a http://www.protocolanalyser.com/d250spec.htm="">DLM-250</a>,
which adds more buffer RAM, and on-board LEDs for monitoring the signal
leads.)</p>

            <p> My unit was invaluable for retesting many
devices, when I
lost my 8-year-old database of serial info. This analyzer is in my <a href="../MyDoctorBag/doctorbag.html">Serial Doctor Bag</a>
that's with me most of the time. I'm very pleased with it's
performance, and with Benedict Computing.</p>

            </td>

            <td style="width: 35%; vertical-align: top; background-color: rgb(225, 255, 224);"><span style="font-weight: bold;">Testing Results Summary</span><br>

(Hardware I've tested that doesn't send unexpected BREAK)<br>

            <br>

            <a href="breakinfo.html#cisco">Cisco NM-16A,
NM-32A</a><br>

            <a href="breakinfo.html#cisco">Cisco HWIC-8A,
-16A</a><br>

            <a href="breakinfo.html#computone">Computone
RAS2000</a><br>

            <a href="breakinfo.html#cyclades">Cyclades TS
and ACS</a><br>

            <a href="breakinfo.html#dnpg">DNPG DECserver</a><br>

            <a href="breakinfo.html#digi">Digi CM</a><br>

            <a href="breakinfo.html#itouch">iTouch
InReach 8000</a><br>

            <a href="breakinfo.html#opengear">Opengear CM</a><br>

            <a href="breakinfo.html#perle">Perle CS9000</a><br>

            <br>

Detailed info is available on the <a href="breakinfo.html">BREAK-off
Test Results</a> page.</td>

          </tr>

        </tbody>
      </table>

      </td>

    </tr>

  </tbody>
</table>

</p>

<p>
<table border="0" width="100%">

  <tbody>

    <tr>

      <td>
      <p><b>Why do we care?</b></p>

      <p>We consider remote access to serial ports to be a very
valuable tool in administering many large enterprise networks, and many
of our peers do as well. To that end, we normally deploy a logging <a href="http://www.conserver.com/">console server application</a>
at sites that we service, and we have also deployed a number of
terminal servers over the years to extend our administration reach
throughout those networks. </p>

      <p>Unfortunately, many terminal servers have this
unexpected serial
BREAK problem. More problematic is the fact that many of the large
sites we support use Sun workstations and computers; </p>

      <ul>

        <li>Sun servers usually respond to serial BREAK by going
to the OK prompt.
          <ul>

            <li>Most operations are suspended, rather than being
killed. </li>

          </ul>

        </li>

        <li>Older Terminal Servers can send BREAK to all attached
devices at inappropriate times.
          <ul>

            <li>Some terminal servers can support 192
devices...so you could halt 192 Suns at once... </li>

          </ul>

        </li>

        <li>Once halted, you have to get on each port and type GO
to get things running again.
          <ul>

            <li>Each server can support thousands of simultaneous
users, who may lose work... </li>

            <li>You need to wait for the terminal servers to
accept remote connections again. </li>

            <li>It takes time to remotely access each port, one
at a time. </li>

            <li>It's hard to automate this process. </li>

          </ul>

        </li>

        <li>There are various ways you can inhibit a SUN from
detecting, or responding to, the BREAK signal.
          <ul>

            <li>As a Sysadmin, sometimes you need to use BREAK,
to get the machine to respond to you, so making it ignore the signal
would be Bad. </li>

            <li>Some fixes are not available on older versions of
OS. </li>

            <li>Some fixes are not available unless you have a
current support agreement. </li>

          </ul>

        </li>

      </ul>

      <p>Simply put, we don't want to give up the benefits that
remote access to serial consoles brings us, so we want to know which
terminal servers won't cause these problems. As a result of that need,
we're putting a bunch of different equipment through the mill, and
telling the Web what we find out.</p>

      <p><span style="font-style: italic;">Shameless
plugs:</span> Last year, <a href="http://www.sysadminmag.com/">SysAdmin
Magazine</a> produced a special <a href="http://www.samag.com/articles/2005/0514/">Console
Server supplement</a>
with their September issue. (There was another Console Server
supplement with the May 2006 issue, but I didn't contribute to that
issue.) Look back to the September/October 2000 issue of <b>;login:</b>
for an <a href="../Training/login-story.html">article</a>
about deploying remote access to console ports. Also, the current
keeper of the <a href="http://www.conserver.com/">Conserver
application</a> and I taught a half-day tutorial (<a href="http://www.usenix.org/events/lisa2000/tutorials/tutmon.html#m12">M12</a>)
at the <a href="http://www.usenix.org/events/lisa2000/">LISA
2000</a> conference in early December, on deploying the Conserver
application, and using Terminal Servers for remote access to serial
consoles. I taught again at <a href="http://www.usenix.org/events/lisa02/tutorials/tuttues.html#T9">LISA
in 2002.</a></p>

      </td>

    </tr>

  </tbody>
</table>

</p>

<p>
<table border="0" width="100%">

  <tbody>

    <tr>

      <td>
      <p><b>What we are doing to test these theories:</b></p>

      <p>We started this project because getting information on
whether or not a device has the serial BREAK problem was more like
tracking down an urban legend than science. Even with high confidence
in a device, you can usually find someone who will suggest that some
unidentified third party has had some trouble with that same device in
the past... </p>

      </td>

    </tr>

  </tbody>
</table>

</p>

Our lab testbed consists of a small IP subnet, a target host
(Sun
SPARC 5 and a Sun Netra T-1 105), a Conserver (HP Laptop running Linux,
or an iMac runnning OS X) which can also be a
TFTP and applications host, a handful of terminal server units under
test, and another system or two as a Conserver client and running a
terminal application to use the serial port for additional
diagnostics, as well as pinging the target host.
<p>
<table border="0" width="100%">

  <tbody>

    <tr>

      <td>
      <p>In our lab, we have divided the duties a bit, so that
the Server performs the Conserver and TFTP duties, while another
computer
performs most of the terminal emulation duties.</p>

      <p>
      <table border="0" width="98%">

        <tbody>

          <tr>

            <td width="315">
            <p><img src="breaklab2.gif" x-sas-useimagewidth="" x-sas-useimageheight="" align="left" height="117" width="302"> </p>

            </td>

            <td>
            <ol>

              <li>Server </li>

              <li>Target </li>

              <li>Laptop </li>

              <li>DUT #1 </li>

              <li>DUT #2 </li>

              <li>DUT #3 </li>

            </ol>

            </td>

          </tr>

        </tbody>
      </table>

      </p>

      <p>All of the devices are connected to a common ethernet
segment. The Laptop has a serial port (shown as the green lines in the
illustration above), which we use to communicate with many of the
Devices Under Test (DUT) for their initial configurations. We then
connect each DUT in turn, via serial (shown in the illustrations as an
orange line) to the target Sun machine, and then perform the various
tests, and see if the host is brought to the OK prompt.</p>

      </td>

    </tr>

  </tbody>
</table>

</p>

<p>In one case, we shared our test methods with a team at another
site (Jeff Komori and Jim Dumont at
<a href="http://www.synopsys.com/">Synopsys</a>),
and asked them to
test some hardware that they could not loan us.</p>

<p><b>The result is a very high confidence in the Cisco
3600 series
devices (3620, 3640, 3660) and the Cisco 2600 series devices (2621
tested) with the NM-32A modules. They have not sent a detectable
BREAK signal under our test conditions</b>.</p>

<ul>

  <i>To date, I've had three reports that the Cisco NM-32A
interface
did send BREAK to a Sun host. In the first case I found out too late to
repeat the problem, but the hypothesis was that a non-standard serial
adapter had been the cause. In the second case, we did trace the source
of the trouble to an incorrectly-wired adapter. (However, I never
received a schematic for the incorrect adapter, so I'm still not sure
WHY the BREAK signal was detected this way.) The third case was
attributed to using a non-Cisco adapter, which could not be disected
(case-molded part). Swapping in a Cisco adapter cleared up the problem.</i>
</ul>

<p>I do realize that good science relies on larger sample pools.
We
are continuing to solicit loaner equipment that we can put through
our testbed. As we run out of easy access to equipment, we will begin
to accept more offers from other teams at universities and other
large sites to perform this testing on their own gear using our test
methods. We'll review their test results, and add those results to
our database as 'external data' submissions, in order to identify
which testing we have performed personally. The initial test run is
intended to help prove out how many devices have software-related
causes versus hardware-related causes, and which devices do not
exhibit the problem.</p>

<p>During BREAK testing of products, I'm willing to share product
specifics with my vendor contact prior to publication of my test
report. (That is, I'll tell Cisco what we found about the Cisco gear,
tell Nortel about the Nortel/Bay/Annex gear, etc.) However, I'm
interested whether anyone thinks that would be a bad idea (and why), so
I can plan accordingly, and set appropriate expectations with the
vendor contacts. So far, I think this method has worked very well.</p>

<p>I have prepared a <a href="breakfaq.html">F.A.Q.
page</a> for this testing
project, if you want to know more about the processes used to get
products
in to test.</p>

<p>
<table border="0" width="100%">

  <tbody>

    <tr>

      <td>
      <p><b>More about BREAK</b></p>

      <p><a href="http://www.conserver.com/">Conserver</a>
allows remote client users to invoke the terminal server to issue a
BREAK on individual serial ports. This is one of the many features that
makes Conserver useful, and popular. </p>

      </td>

    </tr>

  </tbody>
</table>

</p>

<p>Sun offers an option to tell the CPU to ignore BREAK over the
serial console. However, there are times when you <b>NEED </b>to
send
a BREAK to the CPU. If you have used this option, then you need to
keep a monitor and keyboard attached to the unit in order to force
that BREAK when you need it.
(<a href="http://www.conserver.com/">Conserver</a>
is intended to
help free up computer room space by allowing System Administrators to
remove those extra keyboards and displays.)</p>

<p>Some terminal server vendors reportedly include a mode, or
line
settings, which will keep the serial ports from sending BREAK. While
it may keep the port from sending the signal at inappropriate times,
if that mode/setting also keeps Conserver from sending the BREAK
signal when we need to, this would not be a useful option.Cisco
reportedly has an ECO in place, which modified the main board inside
the 2511 product to address the BREAK issue. I'm still looking for
info about how you can tell without testing if your units should or
shouldn't send BREAK.</p>

<p>Cisco reportedly had an ECO in place, which modified the main
board inside the <span style="font-weight: bold;">2511-RJ</span>
product to address the BREAK issue.
(More info on our <a href="breakinfo.html#cisco">testing
result page</a>.)</p>

<p>Cisco also refers to a <span style="font-weight: bold;">NuData</span>
device (NUD-4723 non-aborting
serial
cable) that you can attach in-line between serial consoles and the
terminal server. The devices are $100 (US), and used to be available
through NuData at 1-800-844-5757. (The *-warehouse vendors no longer
carry this part.)</p>

<p><a href="http://www.asptech.com/">ASP Technologies</a>
manufactures a commercial console server application called
<a href="http://www.asptech.com/">Vantage</a>, but
they also
manufactures some interesting
<a href="http://www.datacomideas.com/">hardware dongles</a>
that
prevent certain devices (Digi STS-1600, Xyplex terminal servers) from
sending serial BREAK! This is different than the NuData RS-232
in-line BREAK filter which is referred to in the Cisco tech notes. For
the Digi units (and others?) it is a dongle that connects between the
power supply and the SCSI-attached pod. For the Xyplex, you need to
use a soldering iron after opening the case, but this could be
cheaper and easier than spending $100 US per port for the NuData
devices.</p>

<p>
<table border="0" width="100%">

  <tbody>

    <tr>

      <td>
      <p><b>Test Methodologies</b></p>

      <p>The BREAK signal is an inversion of the data lead for a
specific period of time, exceeding the period of one character,
including the start/stop bits, and any parity. As such, the duration of
the BREAK signal is a function of the port speed of the UART sending
the data. However, many UARTS will send a BREAK signal that is 4 times
as long (some are 16-times as long) as a single character. Some DEC
manuals state that the period is actually ~250 milliseconds, and many
VT-terminals will send a long BREAK signal.</p>

      <p>Simple visual observation may be possible with a passive
RS-232 signal tracer for most devices. This can tell us whether the
BREAK occurs immediately after Power Off or Power On, or if it occurs
later in the boot cycle, during a warm-boot of the device, or a reset
of the serial interface, and by invocation from Conserver. (Sun devices
are sensitive to short BREAK signals. If your port speed is set to
higher than 9600 bps, it can be difficult to see a short BREAK signal.
For our testing, we set the port speeds to 9600 whenever possible.) </p>

      </td>

    </tr>

  </tbody>
</table>

</p>

<p>
<table border="0" width="100%">

  <tbody>

    <tr>

      <td>
      <p>Other testing includes measuring the actual power output
of the RS-232 drivers. While the specification calls for up to +/-25VDC
for the low/high logic signals, the "no-man's land" range (where "data
is invalid") is down at +/-3V. It is possible for devices to output
less power, but then they won't drive a signal as far...and we might
care about that when we consider large data center installations. Since
some devices use newer I.C.s with charge-pump technology, its possible
to see levels closer to +/-6V or +/-9V, and still work OK except in
some edge cases with long cable runs. Most devices so far have voltages
between +/- 13V to +/- 8V.- </p>

      <p><img src="cs-volts-2.gif" x-sas-useimagewidth="" x-sas-useimageheight="" align="left" height="165" width="243">If the
power rails are to blame, the signal could last longer than a normal
BREAK. If this is the case, it is possible that the Sun CPU is "too
sensitive" to BREAK. That is, if the signal doesn't return to normal
after the prescribed time period (as I believe a power rail-induced
failure would cause), the signal should probably be ignored, rather
than acted upon. </p>

      <p>If this is a power condition-related failure, we would
likely need a digital oscilloscope, or similar device that could
trigger on a signal event, capture the waveforms of the TXD and RXD
leads (voltage over time), as well as perhaps the logic power rail
voltage, and then export that display to a Polaroid photo, a printer,
or an image file on a floppy, so that we could include the image in our
slides and write-ups. </p>

      </td>

    </tr>

  </tbody>
</table>

</p>

<p>
<hr align=center width="80%">
</p>

<A NAME="credits"></a>
<P><CENTER><TABLE BORDER=5 bgcolor="ffcc99" width="75%" padding=5>
   <TR>
      <TD>
         <P><FONT COLOR="#663300"><B>NOTICE:</B> Most of the pages, 
         articles, and tutorials on this website are
         copyrighted works. You may make 'deep links' to various
         pages. (If you let me know which page(s) you are linking to,
         I'll let you know if I move the page(s) during updates.)
         Please send me email if you wish to republish any material,
         or use it on your own website.</FONT></P>
      </TD></TR>
</TABLE></CENTER></P>


<p><center>Made using <a href="http://www.nvudev.com">Nvu</a></center></p>

<p><center>Copyright 1996-2009,
<A HREF="http://www.esperanto.org/person/HARRIS_Dacxjo/">David K. Z.
Harris, N6UOW</A>&nbsp;&nbsp;
<a href="http://www.linkedin.com/in/consoleteam" >
<img src="http://www.linkedin.com/img/webpromo/btn_profile_bluetxt_80x15.gif"
width="80" height="15" border="0" alt="View David K. Z. Harris's profile on
LinkedIn"></a><br>
Questions? Comments? Additions? Email <B>consoles</B> at
<B>conserver.com</B>.<BR>

<FONT COLOR="#cc0000">(Don't harvest my address, I don't want
SPAM!)</FONT><BR>

<A HREF="../iloj.html">How does he do it</A>? And
<A HREF="../about.html">Why</A>?</CENTER></P>


</body>
</html>
